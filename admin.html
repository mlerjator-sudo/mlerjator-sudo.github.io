<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F34 Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Noto+Sans+KR:wght@300;400;700;900&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Outfit', 'Noto Sans KR', sans-serif;
            background: #0f172a;
            color: #f8fafc;
        }

        .glass {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 24px;
        }

        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-4px);
            background: rgba(255, 255, 255, 0.06);
        }

        .tab-btn {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }

        .tab-btn.active {
            color: #3b82f6;
            border-color: #3b82f6;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        /* Minecraft Inventory Style */
        .minecraft-inventory {
            background: url('https://i.imgur.com/hbnv4bY.png') center/contain no-repeat, 
                        linear-gradient(to bottom, #373737 0%, #8b8b8b 50%, #373737 100%);
            border: 4px solid #000;
            box-shadow: inset 2px 2px 0 rgba(255, 255, 255, 0.15), 
                        inset -2px -2px 0 rgba(0, 0, 0, 0.5),
                        0 0 30px rgba(0, 0, 0, 0.9);
            padding: 30px 40px;
            border-radius: 0;
            max-width: 600px;
            margin: 0 auto;
        }

        .mc-search-field {
            background: #000;
            border: 2px solid #373737;
            box-shadow: inset 1px 1px 0 rgba(0, 0, 0, 0.8);
            color: #fff;
            padding: 12px 16px;
            font-size: 16px;
            font-family: 'Minecraft', 'Courier New', monospace;
            width: 100%;
            margin-bottom: 20px;
            outline: none;
        }

        .mc-search-field::placeholder {
            color: #888;
        }

        .minecraft-slot {
            position: relative;
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #8b8b8b 0%, #545454 100%);
            border: 3px solid;
            border-color: #373737 #fff #fff #373737;
            box-shadow: inset 0 0 0 1px #1a1a1a;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.1s ease;
            image-rendering: pixelated;
        }

        .minecraft-slot:hover {
            background: linear-gradient(135deg, #fff 0%, #c6c6c6 100%);
            border-color: #fff #373737 #373737 #fff;
        }

        .minecraft-slot.selected {
            background: linear-gradient(135deg, #ffeb3b 0%, #ffc107 100%);
            box-shadow: 0 0 20px rgba(255, 235, 59, 0.8);
        }

        .minecraft-item-icon {
            width: 64px;
            height: 64px;
            image-rendering: pixelated;
            filter: drop-shadow(1px 1px 0 rgba(0, 0, 0, 0.5));
        }

        .minecraft-tooltip {
            position: absolute;
            background: rgba(16, 0, 16, 0.94);
            border: 2px solid;
            border-color: #2d0a63 #100036 #100036 #2d0a63;
            color: #fff;
            padding: 8px 10px;
            font-size: 13px;
            font-family: 'Minecraft', 'Courier New', monospace;
            white-space: nowrap;
            pointer-events: none;
            z-index: 1000;
            display: none;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            text-shadow: 2px 2px 0 rgba(0, 0, 0, 0.8);
        }

        .minecraft-slot:hover .minecraft-tooltip {
            display: block;
        }

        .inventory-grid {
            display: flex;
            gap: 16px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .mc-pagination {
            text-align: center;
            color: #00ffff;
            font-family: 'Minecraft', 'Courier New', monospace;
            font-size: 14px;
            text-shadow: 2px 2px 0 rgba(0, 0, 0, 0.8);
            margin-top: 15px;
        }

        .mc-pagination kbd {
            background: #373737;
            border: 2px solid #000;
            padding: 4px 8px;
            border-radius: 3px;
            color: #fff;
        }

        /* Category theme backgrounds */
        .card-with-bg,
        .card-with-bg-convenience,
        .card-with-bg-food,
        .card-with-bg-worldgen,
        .card-with-bg-adventure,
        .card-with-bg-transportation,
        .card-with-bg-horror,
        .card-with-bg-decoration,
        .card-with-bg-economy,
        .card-with-bg-gamemechanics,
        .card-with-bg-library,
        .card-with-bg-magic,
        .card-with-bg-management,
        .card-with-bg-minigame,
        .card-with-bg-equipment,
        .card-with-bg-mobs,
        .card-with-bg-optimization,
        .card-with-bg-social,
        .card-with-bg-storage,
        .card-with-bg-technology {
            position: relative;
            overflow: hidden;
        }

        .card-with-bg::before,
        .card-with-bg-convenience::before,
        .card-with-bg-food::before,
        .card-with-bg-worldgen::before,
        .card-with-bg-adventure::before,
        .card-with-bg-transportation::before,
        .card-with-bg-horror::before,
        .card-with-bg-decoration::before,
        .card-with-bg-economy::before,
        .card-with-bg-gamemechanics::before,
        .card-with-bg-library::before,
        .card-with-bg-magic::before,
        .card-with-bg-management::before,
        .card-with-bg-minigame::before,
        .card-with-bg-equipment::before,
        .card-with-bg-mobs::before,
        .card-with-bg-optimization::before,
        .card-with-bg-social::before,
        .card-with-bg-storage::before,
        .card-with-bg-technology::before {
            content: "";
            position: absolute;
            inset: 0;
            background-size: cover;
            background-position: center;
            opacity: 0.5;
            z-index: 0;
        }

        .card-with-bg::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/UVF1O71.png'); }
        .card-with-bg-convenience::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/egPJEIy.png'); }
        .card-with-bg-food::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/bshbJZN.png'); }
        .card-with-bg-worldgen::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/FKnjOph.png'); }
        .card-with-bg-adventure::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('Category Theme/Adventure/white.png'); }
        .card-with-bg-transportation::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/MwC3J8v.png'); }
        .card-with-bg-horror::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/1p6lwci.png'); }
        .card-with-bg-decoration::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/VsOr7yM.png'); }
        .card-with-bg-economy::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/aXJFQOK.png'); }
        .card-with-bg-gamemechanics::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/9qlwxkW.png'); }
        .card-with-bg-library::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/9axqQU9.png'); }
        .card-with-bg-magic::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/LlIwrdE.png'); }
        .card-with-bg-management::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/aFQkvpT.png'); }
        .card-with-bg-minigame::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/46rmCIx.png'); }
        .card-with-bg-equipment::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/m5J4zkN.png'); }
        .card-with-bg-mobs::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/CXN3MnX.png'); }
        .card-with-bg-optimization::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/gryd6LR.png'); }
        .card-with-bg-social::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/d8CggAE.png'); }
        .card-with-bg-storage::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/GoJD0yA.png'); }
        .card-with-bg-technology::before { background-image: linear-gradient(180deg, rgba(15, 23, 42, 0.55), rgba(15, 23, 42, 0.85)), url('https://i.imgur.com/VGYKLCU.png'); }

        .card-with-bg > *,
        .card-with-bg-convenience > *,
        .card-with-bg-food > *,
        .card-with-bg-worldgen > *,
        .card-with-bg-adventure > *,
        .card-with-bg-transportation > *,
        .card-with-bg-horror > *,
        .card-with-bg-decoration > *,
        .card-with-bg-economy > *,
        .card-with-bg-gamemechanics > *,
        .card-with-bg-library > *,
        .card-with-bg-magic > *,
        .card-with-bg-management > *,
        .card-with-bg-minigame > *,
        .card-with-bg-equipment > *,
        .card-with-bg-mobs > *,
        .card-with-bg-optimization > *,
        .card-with-bg-social > *,
        .card-with-bg-storage > *,
        .card-with-bg-technology > * {
            position: relative;
            z-index: 1;
        }
    </style>
</head>

<body class="min-h-screen">
    <!-- Login Screen -->
    <div id="login-screen" class="fixed inset-0 z-[100] bg-slate-950 flex items-center justify-center p-6">
        <div class="glass p-12 max-w-md w-full text-center">
            <img src="logo.png" alt="Logo" class="h-24 mx-auto mb-8 rounded-2xl">
            <h1 class="text-3xl font-black mb-2">Admin Access</h1>
            <p class="text-slate-500 mb-8">Please login with an authorized administrator account.</p>
            <button id="login-btn"
                class="w-full py-4 rounded-2xl bg-white text-black font-bold hover:bg-slate-200 transition-colors flex items-center justify-center gap-3">
                <svg class="w-5 h-5" viewBox="0 0 24 24">
                    <path fill="currentColor"
                        d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                    <path fill="currentColor"
                        d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                    <path fill="currentColor"
                        d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z" />
                    <path fill="currentColor"
                        d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                </svg>
                Login with Google
            </button>
            <p id="login-error" class="text-red-400 text-sm mt-4 hidden"></p>
        </div>
    </div>

    <!-- Main Admin Panel -->
    <div id="admin-panel" class="hidden">
        <!-- Sidebar/Header -->
        <header class="glass sticky top-0 z-40 mx-6 mt-6 p-4 flex justify-between items-center border-white/10">
            <div class="flex items-center gap-8">
                <div class="flex items-center gap-3">
                    <img src="logo.png" alt="Logo" class="h-10 rounded-lg">
                    <span class="font-black tracking-tighter text-xl">ADMIN</span>
                </div>
                <nav class="flex gap-2">
                    <button onclick="switchTab('configs')" id="tab-configs"
                        class="tab-btn active px-6 py-2 font-bold text-sm">Approvals</button>
                    <button onclick="switchTab('players')" id="tab-players"
                        class="tab-btn px-6 py-2 font-bold text-sm">Players</button>
                    <button onclick="switchTab('support')" id="tab-support"
                        class="tab-btn px-6 py-2 font-bold text-sm">Tickets</button>
                </nav>
            </div>
            <div class="flex items-center gap-4">
                <div class="glass p-1 flex flex-wrap gap-1 text-[10px] font-bold uppercase">
                    <button onclick="setLang('en')" id="lang-en" class="px-3 py-1.5 rounded-lg">EN</button>
                    <button onclick="setLang('ko')" id="lang-ko" class="px-3 py-1.5 rounded-lg">KO</button>
                    <button onclick="setLang('jp')" id="lang-jp" class="px-3 py-1.5 rounded-lg">JP</button>
                    <button onclick="setLang('cn')" id="lang-cn" class="px-3 py-1.5 rounded-lg">CN</button>
                    <button onclick="setLang('es')" id="lang-es" class="px-3 py-1.5 rounded-lg">ES</button>
                    <button onclick="setLang('fr')" id="lang-fr" class="px-3 py-1.5 rounded-lg">FR</button>
                    <button onclick="setLang('de')" id="lang-de" class="px-3 py-1.5 rounded-lg">DE</button>
                    <button onclick="setLang('ru')" id="lang-ru" class="px-3 py-1.5 rounded-lg">RU</button>
                    <button onclick="setLang('pt')" id="lang-pt" class="px-3 py-1.5 rounded-lg">PT</button>
                    <button onclick="setLang('it')" id="lang-it" class="px-3 py-1.5 rounded-lg">IT</button>
                    <button onclick="setLang('vi')" id="lang-vi" class="px-3 py-1.5 rounded-lg">VI</button>
                    <button onclick="setLang('th')" id="lang-th" class="px-3 py-1.5 rounded-lg">TH</button>
                    <button onclick="setLang('id')" id="lang-id" class="px-3 py-1.5 rounded-lg">ID</button>
                </div>
                <button id="auth-btn" class="glass px-6 py-2 font-bold text-xs hover:bg-white/10 transition-all">
                    Logout
                </button>
            </div>
        </header>

        <main class="max-w-7xl mx-auto p-6">
            <!-- Section: Config Approvals -->
            <div id="section-configs" class="space-y-6">
                <div class="flex justify-between items-end mb-8">
                    <h2 class="text-2xl font-bold" id="t-pending-title">Pending Approvals</h2>
                </div>
                <div class="minecraft-inventory">
                    <input type="text" id="mc-search" class="mc-search-field" placeholder="Search...">
                    <div class="inventory-grid" id="config-list">
                        <!-- Minecraft-style config slots will be injected here -->
                    </div>
                    <div class="mc-pagination">
                        <kbd>F4</kbd> Îã§Ïùå (<span id="current-page">1</span>/<span id="total-pages">1</span>)
                    </div>
                </div>
            </div>

            <!-- Section: Player Management -->
            <div id="section-players" class="hidden space-y-6">
                <div class="flex justify-between items-end mb-8">
                    <h2 class="text-2xl font-bold" id="t-players-title">Player Management</h2>
                </div>
                <div class="glass overflow-hidden">
                    <table class="w-full text-left">
                        <thead>
                            <tr class="bg-white/5 text-[10px] font-bold uppercase tracking-widest text-slate-500">
                                <th class="px-6 py-4">Player</th>
                                <th class="px-6 py-4">Email</th>
                                <th class="px-6 py-4">Grade</th>
                                <th class="px-6 py-4">Warnings</th>
                                <th class="px-6 py-4">Status</th>
                                <th class="px-6 py-4 text-right">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="player-list">
                            <!-- Players will be injected here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Section: Support Center -->
            <div id="section-support" class="hidden space-y-6">
                <div class="flex justify-between items-end mb-8">
                    <h2 class="text-2xl font-bold" id="t-support-title">Support Tickets</h2>
                </div>
                <div id="support-list" class="grid grid-cols-1 gap-6">
                    <!-- Tickets will be injected here -->
                </div>
            </div>
        </main>
    </div>

    <!-- Player Details Modal -->
    <div id="player-modal" class="fixed inset-0 z-50 flex items-center justify-center p-6 hidden">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closePlayerModal()"></div>
        <div class="glass max-w-4xl w-full max-h-[90vh] overflow-y-auto relative z-10 p-8 animate-fade-in">
            <div id="player-modal-content">
                <!-- Content injected here -->
            </div>
        </div>
    </div>

    <!-- Data View Modal -->
    <div id="data-modal" class="fixed inset-0 z-[60] flex items-center justify-center p-6 hidden">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeDataModal()"></div>
        <div class="glass max-w-2xl w-full relative z-10 p-8 animate-fade-in">
            <div id="data-modal-content"></div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { initializeFirestore, collection, query, where, onSnapshot, doc, getDoc, getDocs, updateDoc, deleteDoc, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { initializeAuth, browserLocalPersistence, browserPopupRedirectResolver, signInWithPopup, signInWithRedirect, getRedirectResult, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyA827pUzqfTpGpGbT9uKXKEjZo3hYl5ENo",
            authDomain: "f34-di.firebaseapp.com",
            projectId: "f34-di",
            storageBucket: "f34-di.firebasestorage.app",
            messagingSenderId: "660590227115",
            appId: "1:660590227115:web:0f1ca3aa9464f2406c11ee"
        };

        const ADMIN_EMAILS = ["gangminseogg13t@gmail.com"];
        const ADMIN_UID = "3HhMIE2eDTcev32kChg08g1GjNO2";

        const i18n = {
            en: {
                pendingTitle: "Pending Approvals",
                noConfigs: "No pending configurations.",
                approve: "Approve",
                reject: "Reject",
                playersTitle: "Player Management",
                supportTitle: "Support Tickets",
                noTickets: "No support tickets.",
                ticketTitle: "Support Request",
                ticketUser: "User",
                ticketDate: "Date",
                ticketDelete: "Delete Ticket",
                playerBan: "Ban Player",
                playerUnban: "Unban",
                playerWarn: "Warn",
                playerDelete: "Delete Account",
                playerConfigs: "Deployed Configs",
                banHours: "Hours",
                banStatus: "Banned until:",
                activeStatus: "Active",
                playerGrade: "Player Grade",
                grades: {
                    General: "General", Wood: "Wood", Stone: "Stone", Coal: "Coal", Copper: "Copper", Iron: "Iron", Gold: "Gold", Diamond: "Diamond", Emerald: "Emerald", Premium: "Premium"
                },
                categories: { General: "General" },
                instanceName: "Instance Name",
                functionDescription: "Function",
                viewData: "View Data",
                close: "Close"
            },
            ko: {
                pendingTitle: "ÏäπÏù∏ ÎåÄÍ∏∞ Ï§ëÏù∏ ÏÑ§Ï†ï",
                noConfigs: "ÎåÄÍ∏∞ Ï§ëÏù∏ ÏÑ§Ï†ïÏù¥ ÏóÜÏäµÎãàÎã§.",
                approve: "ÏäπÏù∏",
                reject: "Í±∞Ï†à",
                playersTitle: "ÌîåÎ†àÏù¥Ïñ¥ Í¥ÄÎ¶¨",
                supportTitle: "Í≥†Í∞ù ÏÑºÌÑ∞ Î¨∏Ïùò",
                noTickets: "Ï†ëÏàòÎêú Î¨∏ÏùòÍ∞Ä ÏóÜÏäµÎãàÎã§.",
                ticketTitle: "Í≥†Í∞ù Î¨∏Ïùò",
                ticketUser: "ÏûëÏÑ±Ïûê",
                ticketDate: "ÎÇ†Ïßú",
                ticketDelete: "Î¨∏Ïùò ÏÇ≠Ï†ú",
                playerBan: "ÌîåÎ†àÏù¥Ïñ¥ Ï∞®Îã®",
                playerUnban: "Ï∞®Îã® Ìï¥Ï†ú",
                playerWarn: "Í≤ΩÍ≥†",
                playerDelete: "Í≥ÑÏ†ï ÏÇ≠Ï†ú",
                playerConfigs: "Î∞∞Ìè¨Ìïú ÏÑ§Ï†ï Î™©Î°ù",
                banHours: "ÏãúÍ∞Ñ",
                banStatus: "Ï∞®Îã® ÎßåÎ£å:",
                activeStatus: "Ï†ïÏÉÅ",
                playerGrade: "ÌîåÎ†àÏù¥Ïñ¥ Îì±Í∏â",
                grades: {
                    General: "ÏùºÎ∞ò", Wood: "ÎÇòÎ¨¥", Stone: "Îèå", Coal: "ÏÑùÌÉÑ", Copper: "Íµ¨Î¶¨", Iron: "Ï≤†", Gold: "Í∏à", Diamond: "Îã§Ïù¥ÏïÑÎ™¨Îìú", Emerald: "ÏóêÎ©îÎûÑÎìú", Premium: "ÌîÑÎ¶¨ÎØ∏ÏóÑ"
                },
                categories: { General: "ÏùºÎ∞ò" },
                instanceName: "Ïù∏Ïä§ÌÑ¥Ïä§ Î™ÖÎ™ÖÏñ¥",
                functionDescription: "Í∏∞Îä• ÏÑ§Î™Ö",
                viewData: "Îç∞Ïù¥ÌÑ∞ Î≥¥Í∏∞",
                close: "Îã´Í∏∞"
            },
            jp: {
                pendingTitle: "ÊâøË™çÂæÖ„Å°„ÅÆË®≠ÂÆö",
                noConfigs: "‰øùÁïô‰∏≠„ÅÆË®≠ÂÆö„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ",
                approve: "ÊâøË™ç",
                reject: "ÊãíÂê¶",
                playersTitle: "„Éó„É¨„Ç§„É§„ÉºÁÆ°ÁêÜ",
                supportTitle: "„Çµ„Éù„Éº„Éà„ÉÅ„Ç±„ÉÉ„Éà",
                noTickets: "„Çµ„Éù„Éº„Éà„ÉÅ„Ç±„ÉÉ„Éà„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ",
                ticketTitle: "„Çµ„Éù„Éº„Éà„É™„ÇØ„Ç®„Çπ„Éà",
                ticketUser: "„É¶„Éº„Ç∂„Éº",
                ticketDate: "Êó•‰ªò",
                ticketDelete: "„ÉÅ„Ç±„ÉÉ„Éà„ÇíÂâäÈô§",
                playerBan: "„Éó„É¨„Ç§„É§„Éº„ÇíÁ¶ÅÊ≠¢",
                playerUnban: "Á¶ÅÊ≠¢Ëß£Èô§",
                playerWarn: "Ë≠¶Âëä",
                playerDelete: "„Ç¢„Ç´„Ç¶„É≥„Éà„ÇíÂâäÈô§",
                playerConfigs: "„Éá„Éó„É≠„Ç§„Åï„Çå„ÅüË®≠ÂÆö",
                banHours: "ÊôÇÈñì",
                banStatus: "Á¶ÅÊ≠¢ÊúüÈôê:",
                activeStatus: "„Ç¢„ÇØ„ÉÜ„Ç£„Éñ",
                playerGrade: "„Éó„É¨„Ç§„É§„Éº„É©„É≥„ÇØ",
                grades: {
                    General: "‰∏ÄËà¨", Wood: "Êú®", Stone: "Áü≥", Coal: "Áü≥ÁÇ≠", Copper: "ÈäÖ", Iron: "ÈâÑ", Gold: "Èáë", Diamond: "„ÉÄ„Ç§„É§„É¢„É≥„Éâ", Emerald: "„Ç®„É°„É©„É´„Éâ", Premium: "„Éó„É¨„Éü„Ç¢„É†"
                },
                categories: { General: "‰∏ÄËà¨" },
                instanceName: "„Ç§„É≥„Çπ„Çø„É≥„ÇπÂêç",
                functionDescription: "Ê©üËÉΩ",
                viewData: "„Éá„Éº„ÇøË°®Á§∫",
                close: "Èñâ„Åò„Çã"
            },
            cn: {
                pendingTitle: "ÂæÖÂÆ°ÊâπÈÖçÁΩÆ",
                noConfigs: "Ê≤°ÊúâÂæÖÂ§ÑÁêÜÁöÑÈÖçÁΩÆ„ÄÇ",
                approve: "ÊâπÂáÜ",
                reject: "ÊãíÁªù",
                playersTitle: "Áé©ÂÆ∂ÁÆ°ÁêÜ",
                supportTitle: "ÊîØÊåÅÂ∑•Âçï",
                noTickets: "Ê≤°ÊúâÊîØÊåÅÂ∑•Âçï„ÄÇ",
                ticketTitle: "ÊîØÊåÅËØ∑Ê±Ç",
                ticketUser: "Áî®Êà∑",
                ticketDate: "Êó•Êúü",
                ticketDelete: "Âà†Èô§Â∑•Âçï",
                playerBan: "Á¶ÅÊ≠¢Áé©ÂÆ∂",
                playerUnban: "Ëß£Á¶Å",
                playerWarn: "Ë≠¶Âëä",
                playerDelete: "Âà†Èô§Ë¥¶Êà∑",
                playerConfigs: "Â∑≤ÈÉ®ÁΩ≤ÈÖçÁΩÆ",
                banHours: "Â∞èÊó∂",
                banStatus: "Á¶ÅÊ≠¢Áõ¥Âà∞:",
                activeStatus: "Ê¥ªË∑É",
                playerGrade: "Áé©ÂÆ∂Á≠âÁ∫ß",
                grades: {
                    General: "ÊôÆÈÄö", Wood: "Êú®", Stone: "Áü≥", Coal: "ÁÖ§", Copper: "Èìú", Iron: "ÈìÅ", Gold: "Èáë", Diamond: "ÈíªÁü≥", Emerald: "ÁªøÂÆùÁü≥", Premium: "È´òÁ∫ß"
                },
                categories: { General: "ÊôÆÈÄö" },
                instanceName: "ÂÆû‰æãÂêçÁß∞",
                functionDescription: "ÂäüËÉΩ",
                viewData: "Êü•ÁúãÊï∞ÊçÆ",
                close: "ÂÖ≥Èó≠"
            },
            es: {
                pendingTitle: "Aprobaciones Pendientes",
                noConfigs: "No hay configuraciones pendientes.",
                approve: "Aprobar",
                reject: "Rechazar",
                playersTitle: "Gesti√≥n de Jugadores",
                supportTitle: "Tickets de Soporte",
                noTickets: "No hay tickets de soporte.",
                ticketTitle: "Solicitud de Soporte",
                ticketUser: "Usuario",
                ticketDate: "Fecha",
                ticketDelete: "Eliminar Ticket",
                playerBan: "Banear Jugador",
                playerUnban: "Desbanear",
                playerWarn: "Advertir",
                playerDelete: "Eliminar Cuenta",
                playerConfigs: "Configuraciones Desplegadas",
                banHours: "Horas",
                banStatus: "Baneado hasta:",
                activeStatus: "Activo",
                playerGrade: "Grado del Jugador",
                grades: {
                    General: "General", Wood: "Madera", Stone: "Piedra", Coal: "Carb√≥n", Copper: "Cobre", Iron: "Hierro", Gold: "Oro", Diamond: "Diamante", Emerald: "Esmeralda", Premium: "Premium"
                },
                categories: { General: "General" },
                instanceName: "Nombre de la Instancia",
                functionDescription: "Funci√≥n",
                viewData: "Ver Datos",
                close: "Cerrar"
            },
            fr: {
                pendingTitle: "Approbations en Attente",
                noConfigs: "Aucune configuration en attente.",
                approve: "Approuver",
                reject: "Rejeter",
                playersTitle: "Gestion des Joueurs",
                supportTitle: "Tickets de Support",
                noTickets: "Aucun ticket de support.",
                ticketTitle: "Demande de Support",
                ticketUser: "Utilisateur",
                ticketDate: "Date",
                ticketDelete: "Supprimer le Ticket",
                playerBan: "Bannir le Joueur",
                playerUnban: "D√©bannir",
                playerWarn: "Avertir",
                playerDelete: "Supprimer le Compte",
                playerConfigs: "Configs D√©ploy√©es",
                banHours: "Heures",
                banStatus: "Banni jusqu'au :",
                activeStatus: "Actif",
                playerGrade: "Grade du Joueur",
                grades: {
                    General: "G√©n√©ral", Wood: "Bois", Stone: "Pierre", Coal: "Charbon", Copper: "Cuivre", Iron: "Fer", Gold: "Or", Diamond: "Diamant", Emerald: "√âmeraude", Premium: "Premium"
                },
                categories: { General: "G√©n√©ral" },
                instanceName: "Nom de l'Instance",
                functionDescription: "Fonction",
                viewData: "Voir les Donn√©es",
                close: "Fermer"
            },
            de: {
                pendingTitle: "Ausstehende Genehmigungen",
                noConfigs: "Keine ausstehenden Konfigurationen.",
                approve: "Genehmigen",
                reject: "Ablehnen",
                playersTitle: "Spielerverwaltung",
                supportTitle: "Support-Tickets",
                noTickets: "Keine Support-Tickets.",
                ticketTitle: "Support-Anfrage",
                ticketUser: "Benutzer",
                ticketDate: "Datum",
                ticketDelete: "Ticket l√∂schen",
                playerBan: "Spieler sperren",
                playerUnban: "Entsperren",
                playerWarn: "Warnen",
                playerDelete: "Konto l√∂schen",
                playerConfigs: "Bereitgestellte Konfigs",
                banHours: "Stunden",
                banStatus: "Gesperrt bis:",
                activeStatus: "Aktiv",
                playerGrade: "Spieler-Rang",
                grades: {
                    General: "Allgemein", Wood: "Holz", Stone: "Stein", Coal: "Kohle", Copper: "Kupfer", Iron: "Eisen", Gold: "Gold", Diamond: "Diamant", Emerald: "Smaragd", Premium: "Premium"
                },
                categories: { General: "Allgemein" },
                instanceName: "Instanzname",
                functionDescription: "Funktion",
                viewData: "Daten anzeigen",
                close: "Schlie√üen"
            },
            ru: {
                pendingTitle: "–û–∂–∏–¥–∞—é—â–∏–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è",
                noConfigs: "–ù–µ—Ç –æ–∂–∏–¥–∞—é—â–∏—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π.",
                approve: "–û–¥–æ–±—Ä–∏—Ç—å",
                reject: "–û—Ç–∫–ª–æ–Ω–∏—Ç—å",
                playersTitle: "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞–º–∏",
                supportTitle: "–¢–∏–∫–µ—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏",
                noTickets: "–ù–µ—Ç —Ç–∏–∫–µ—Ç–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∫–∏.",
                ticketTitle: "–ó–∞–ø—Ä–æ—Å –ø–æ–¥–¥–µ—Ä–∂–∫–∏",
                ticketUser: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
                ticketDate: "–î–∞—Ç–∞",
                ticketDelete: "–£–¥–∞–ª–∏—Ç—å —Ç–∏–∫–µ—Ç",
                playerBan: "–ó–∞–±–∞–Ω–∏—Ç—å –∏–≥—Ä–æ–∫–∞",
                playerUnban: "–†–∞–∑–±–∞–Ω–∏—Ç—å",
                playerWarn: "–ü—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç—å",
                playerDelete: "–£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç",
                playerConfigs: "–†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏",
                banHours: "–ß–∞—Å–æ–≤",
                banStatus: "–ó–∞–±–∞–Ω–µ–Ω –¥–æ:",
                activeStatus: "–ê–∫—Ç–∏–≤–µ–Ω",
                playerGrade: "–†–∞–Ω–≥ –∏–≥—Ä–æ–∫–∞",
                grades: {
                    General: "–û–±—â–∏–π", Wood: "–î–µ—Ä–µ–≤–æ", Stone: "–ö–∞–º–µ–Ω—å", Coal: "–£–≥–æ–ª—å", Copper: "–ú–µ–¥—å", Iron: "–ñ–µ–ª–µ–∑–æ", Gold: "–ó–æ–ª–æ—Ç–æ", Diamond: "–ê–ª–º–∞–∑", Emerald: "–ò–∑—É–º—Ä—É–¥", Premium: "–ü—Ä–µ–º–∏—É–º"
                },
                categories: { General: "–û–±—â–∏–π" },
                instanceName: "–ò–º—è –∏–Ω—Å—Ç–∞–Ω—Å–∞",
                functionDescription: "–§—É–Ω–∫—Ü–∏—è",
                viewData: "–ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö",
                close: "–ó–∞–∫—Ä—ã—Ç—å"
            },
            pt: {
                pendingTitle: "Aprova√ß√µes Pendentes",
                noConfigs: "Nenhuma configura√ß√£o pendente.",
                approve: "Aprovar",
                reject: "Rejeitar",
                playersTitle: "Gerenciamento de Jogadores",
                supportTitle: "Tickets de Suporte",
                noTickets: "Nenhum ticket de suporte.",
                ticketTitle: "Solicita√ß√£o de Suporte",
                ticketUser: "Usu√°rio",
                ticketDate: "Data",
                ticketDelete: "Excluir Ticket",
                playerBan: "Banir Jogador",
                playerUnban: "Desbanear",
                playerWarn: "Avisar",
                playerDelete: "Excluir Conta",
                playerConfigs: "Configs Implantadas",
                banHours: "Horas",
                banStatus: "Banido at√©:",
                activeStatus: "Ativo",
                playerGrade: "Grau do Jogador",
                grades: {
                    General: "Geral", Wood: "Madeira", Stone: "Pedra", Coal: "Carv√£o", Copper: "Cobre", Iron: "Ferro", Gold: "Ouro", Diamond: "Diamante", Emerald: "Esmeralda", Premium: "Premium"
                },
                categories: { General: "Geral" },
                instanceName: "Nome da Inst√¢ncia",
                functionDescription: "Fun√ß√£o",
                viewData: "Ver Dados",
                close: "Fechar"
            },
            it: {
                pendingTitle: "Approvazioni in sospeso",
                noConfigs: "Nessuna configurazione in sospeso.",
                approve: "Approva",
                reject: "Rifiuta",
                playersTitle: "Gestione giocatori",
                supportTitle: "Ticket di supporto",
                noTickets: "Nessun ticket di supporto.",
                ticketTitle: "Richiesta di supporto",
                ticketUser: "Utente",
                ticketDate: "Data",
                ticketDelete: "Elimina ticket",
                playerBan: "Banna giocatore",
                playerUnban: "Sblocca",
                playerWarn: "Avverti",
                playerDelete: "Elimina account",
                playerConfigs: "Configurazioni distribuite",
                banHours: "Ore",
                banStatus: "Bannato fino a:",
                activeStatus: "Attivo",
                playerGrade: "Grado giocatore",
                grades: {
                    General: "Generale", Wood: "Legno", Stone: "Pietra", Coal: "Carbone", Copper: "Rame", Iron: "Ferro", Gold: "Oro", Diamond: "Diamante", Emerald: "Smeraldo", Premium: "Premium"
                },
                categories: { General: "Generale" },
                instanceName: "Nome istanza",
                functionDescription: "Funzione",
                viewData: "Visualizza dati",
                close: "Chiudi"
            },
            vi: {
                pendingTitle: "Ph√™ duy·ªát ƒëang ch·ªù x·ª≠ l√Ω",
                noConfigs: "Kh√¥ng c√≥ c·∫•u h√¨nh n√†o ƒëang ch·ªù x·ª≠ l√Ω.",
                approve: "Ph√™ duy·ªát",
                reject: "T·ª´ ch·ªëi",
                playersTitle: "Qu·∫£n l√Ω ng∆∞·ªùi ch∆°i",
                supportTitle: "Y√™u c·∫ßu h·ªó tr·ª£",
                noTickets: "Kh√¥ng c√≥ y√™u c·∫ßu h·ªó tr·ª£ n√†o.",
                ticketTitle: "Y√™u c·∫ßu h·ªó tr·ª£",
                ticketUser: "Ng∆∞·ªùi d√πng",
                ticketDate: "Ng√†y",
                ticketDelete: "X√≥a y√™u c·∫ßu",
                playerBan: "C·∫•m ng∆∞·ªùi ch∆°i",
                playerUnban: "B·ªè c·∫•m",
                playerWarn: "C·∫£nh b√°o",
                playerDelete: "X√≥a t√†i kho·∫£n",
                playerConfigs: "C·∫•u h√¨nh ƒë√£ tri·ªÉn khai",
                banHours: "Gi·ªù",
                banStatus: "B·ªã c·∫•m cho ƒë·∫øn:",
                activeStatus: "ƒêang ho·∫°t ƒë·ªông",
                playerGrade: "C·∫•p ƒë·ªô ng∆∞·ªùi ch∆°i",
                grades: {
                    General: "Chung", Wood: "G·ªó", Stone: "ƒê√°", Coal: "Than", Copper: "ƒê·ªìng", Iron: "S·∫Øt", Gold: "V√†ng", Diamond: "Kim c∆∞∆°ng", Emerald: "L·ª•c b·∫£o", Premium: "Cao c·∫•p"
                },
                categories: { General: "Chung" },
                instanceName: "T√™n phi√™n b·∫£n",
                functionDescription: "Ch·ª©c nƒÉng",
                viewData: "Xem d·ªØ li·ªáu",
                close: "ƒê√≥ng"
            },
            th: {
                pendingTitle: "‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà",
                noConfigs: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà",
                approve: "‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥",
                reject: "‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò",
                playersTitle: "‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô",
                supportTitle: "‡∏ï‡∏±‡πã‡∏ß‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô",
                noTickets: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ï‡∏±‡πã‡∏ß‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô",
                ticketTitle: "‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô",
                ticketUser: "‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ",
                ticketDate: "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà",
                ticketDelete: "‡∏•‡∏ö‡∏ï‡∏±‡πã‡∏ß",
                playerBan: "‡πÅ‡∏ö‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô",
                playerUnban: "‡∏õ‡∏•‡∏î‡πÅ‡∏ö‡∏ô",
                playerWarn: "‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô",
                playerDelete: "‡∏•‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ",
                playerConfigs: "‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ",
                banHours: "‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á",
                banStatus: "‡πÅ‡∏ö‡∏ô‡∏à‡∏ô‡∏ñ‡∏∂‡∏á:",
                activeStatus: "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà",
                playerGrade: "‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô",
                grades: {
                    General: "‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ", Wood: "‡πÑ‡∏°‡πâ", Stone: "‡∏´‡∏¥‡∏ô", Coal: "‡∏ñ‡πà‡∏≤‡∏ô", Copper: "‡∏ó‡∏≠‡∏á‡πÅ‡∏î‡∏á", Iron: "‡πÄ‡∏´‡∏•‡πá‡∏Å", Gold: "‡∏ó‡∏≠‡∏á", Diamond: "‡πÄ‡∏û‡∏ä‡∏£", Emerald: "‡∏°‡∏£‡∏Å‡∏ï", Premium: "‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏°"
                },
                categories: { General: "‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ" },
                instanceName: "‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡∏™‡πÅ‡∏ï‡∏ô‡∏ã‡πå",
                functionDescription: "‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô",
                viewData: "‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
                close: "‡∏õ‡∏¥‡∏î"
            },
            id: {
                pendingTitle: "Persetujuan Tertunda",
                noConfigs: "Tidak ada konfigurasi tertunda.",
                approve: "Setujui",
                reject: "Tolak",
                playersTitle: "Manajemen Pemain",
                supportTitle: "Tiket Dukungan",
                noTickets: "Tidak ada tiket dukungan.",
                ticketTitle: "Permintaan Dukungan",
                ticketUser: "Pengguna",
                ticketDate: "Tanggal",
                ticketDelete: "Hapus Tiket",
                playerBan: "Blokir Pemain",
                playerUnban: "Buka Blokir",
                playerWarn: "Peringatkan",
                playerDelete: "Hapus Akun",
                playerConfigs: "Konfigurasi Terpasang",
                banHours: "Jam",
                banStatus: "Diblokir hingga:",
                activeStatus: "Aktif",
                playerGrade: "Tingkat Pemain",
                grades: {
                    General: "Umum", Wood: "Kayu", Stone: "Batu", Coal: "Batu Bara", Copper: "Tembaga", Iron: "Besi", Gold: "Emas", Diamond: "Berlian", Emerald: "Zamrud", Premium: "Premium"
                },
                categories: { General: "Umum" },
                instanceName: "Nama Instansi",
                functionDescription: "Fungsi",
                viewData: "Lihat Data",
                close: "Tutup"
            }
        };

        let currentLang = localStorage.getItem('f34_lang') || 'en';
        let db, auth, provider;
        let currentUser = null;
        let mcAccount = null;
        let allConfigs = [];
        let allPlayers = [];
        let allTickets = [];
        let dataLoaded = false;
        let currentTab = 'configs';
        let fetchTimeout = null;

        let currentPage = 1;
        const itemsPerPage = 4;
        let filteredConfigs = [];

        const categoryIcons = {
            'General': 'üß±',
            'Equipment': 'üõ°Ô∏è',
            'Food': 'üçñ',
            'Magic': 'üîÆ',
            'Management': '‚öôÔ∏è',
            'Technology': 'üîß',
            'Transportation': 'üöÇ',
            'Adventure': 'üó∫Ô∏è',
            'Horror': 'üëª',
            'Social': 'üí¨',
            'Storage': 'üì¶',
            'Mobs': 'üßü',
            'Optimization': '‚ö°',
            'Minigame': 'üéÆ',
            'Library': 'üìö',
            'Decoration': 'üé®',
            'Economy': 'üí∞',
            'Convenience': 'üîë',
            'World Gen': 'üåç'
        };

        function normalizeCategory(cat) {
            return (cat || '').toString().toLowerCase().replace(/\s+/g, '');
        }
        
        function normalizeCategoryAlias(cat) {
            const base = normalizeCategory(cat);
            if (base === 'mechanics') return 'gamemechanics';
            return base;
        }

        function log(msg) { console.log(`[F34 Admin] ${msg}`); }

        function updatePagination() {
            const totalPages = Math.ceil(filteredConfigs.length / itemsPerPage);
            document.getElementById('current-page').textContent = currentPage;
            document.getElementById('total-pages').textContent = totalPages || 1;
        }

        function renderConfigs() {
            if (!dataLoaded) return;
            const t = i18n[currentLang] || i18n.en;
            const configList = document.getElementById('config-list');
            const searchInput = document.getElementById('mc-search');
            
            if (!configList) return;
            
            if (allConfigs.length === 0) {
                configList.innerHTML = `<div class="col-span-full text-center text-xl" style="color: #888;">ÎåÄÍ∏∞ Ï§ëÏù∏ ÏÑ§Ï†ïÏù¥ ÏóÜÏäµÎãàÎã§.</div>`;
                return;
            }
            
            const searchTerm = searchInput ? searchInput.value.toLowerCase() : '';
            filteredConfigs = allConfigs.filter(config => 
                !searchTerm || 
                (config.name && config.name.toLowerCase().includes(searchTerm)) ||
                (config.category && config.category.toLowerCase().includes(searchTerm)) ||
                (config.author && config.author.toLowerCase().includes(searchTerm))
            );
            
            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const pageConfigs = filteredConfigs.slice(start, end);
            
            configList.innerHTML = '';
            
            pageConfigs.forEach((data) => {
                const slot = document.createElement('div');
                slot.className = 'minecraft-slot';
                const icon = categoryIcons[data.category] || 'üìã';
                
                const tooltip = document.createElement('div');
                tooltip.className = 'minecraft-tooltip';
                tooltip.innerHTML = `<div style="color: #fff;">${data.name || 'Untitled'}</div><div style="color: #aaa; font-size: 11px;">${data.category}</div>`;
                
                slot.innerHTML = `
                    <span class="minecraft-item-icon">${icon}</span>
                `;
                slot.appendChild(tooltip);
                
                slot.onclick = (e) => {
                    e.stopPropagation();
                    document.querySelectorAll('.minecraft-slot').forEach(s => s.classList.remove('selected'));
                    slot.classList.add('selected');
                    showConfigData(data.id);
                };
                
                slot.oncontextmenu = (e) => {
                    e.preventDefault();
                    if (confirm(`"${data.name}" ÏÑ§Ï†ïÏùÑ ÏäπÏù∏ÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) {
                        updateStatus(data.id, 'approved');
                    }
                };
                
                configList.appendChild(slot);
            });
            
            updatePagination();
        }
        
        document.addEventListener('keydown', (e) => {
            if (e.key === 'F4') {
                e.preventDefault();
                const totalPages = Math.ceil(filteredConfigs.length / itemsPerPage);
                currentPage = currentPage >= totalPages ? 1 : currentPage + 1;
                renderConfigs();
            }
        });
        
        window.addEventListener('DOMContentLoaded', () => {
            const searchInput = document.getElementById('mc-search');
            if (searchInput) {
                searchInput.addEventListener('input', () => {
                    currentPage = 1;
                    renderConfigs();
                });
            }
        });

        window.setLang = (lang) => {
            currentLang = lang;
            localStorage.setItem('f34_lang', lang);
            updateUI();
        };

        window.switchTab = (tab) => {
            currentTab = tab;
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            const tabBtn = document.getElementById(`tab-${tab}`);
            if (tabBtn) tabBtn.classList.add('active');

            ['configs', 'players', 'support'].forEach(t => {
                const sec = document.getElementById(`section-${t}`);
                if (sec) sec.classList.add('hidden');
            });
            const activeSec = document.getElementById(`section-${tab}`);
            if (activeSec) activeSec.classList.remove('hidden');

            if (tab === 'players') fetchPlayers();
            if (tab === 'support') fetchTickets();
        };

        function updateUI() {
            const t = i18n[currentLang] || i18n.en;
            const pt = document.getElementById('t-pending-title');
            const plt = document.getElementById('t-players-title');
            const st = document.getElementById('t-support-title');

            if (pt) pt.textContent = t.pendingTitle;
            if (plt) plt.textContent = t.playersTitle;
            if (st) st.textContent = t.supportTitle;

            document.querySelectorAll('[id^="lang-"]').forEach(btn => {
                btn.classList.remove('bg-white/10', 'text-blue-400');
                if (btn.id === `lang-${currentLang}`) btn.classList.add('bg-white/10', 'text-blue-400');
            });
            renderConfigs();
            renderPlayers();
            renderTickets();
        }

        function updateInfoPanel(data) {
            const infoPanel = document.getElementById('info-panel');
            const t = i18n[currentLang] || i18n.en;
            infoPanel.innerHTML = `
                <div><span class="info-label">Name:</span> ${data.name || 'Untitled'}</div>
                <div><span class="info-label">Category:</span> ${data.category}</div>
                <div><span class="info-label">Author:</span> ${data.author}</div>
                <div><span class="info-label">Description:</span> ${data.description || 'No description'}</div>
                <div style="margin-top: 10px;">
                    <button onclick="updateStatus('${data.id}', 'approved')" style="background: #4CAF50; color: white; padding: 6px 12px; border: none; border-radius: 3px; cursor: pointer; margin-right: 8px;">${t.approve}</button>
                    <button onclick="updateStatus('${data.id}', 'rejected')" style="background: #f44336; color: white; padding: 6px 12px; border: none; border-radius: 3px; cursor: pointer;">${t.reject}</button>
                </div>
            `;
        }
        
        window.showConfigMenu = (id, element) => {
            const config = allConfigs.find(c => c.id === id);
            if (!config) return;
            updateInfoPanel(config);
        };

        window.showConfigData = (id) => {
            const t = i18n[currentLang] || i18n.en;
            const config = allConfigs.find(c => c.id === id);
            if (!config) return;

            const modal = document.getElementById('data-modal');
            const content = document.getElementById('data-modal-content');
            if (modal && content) {
                let formattedData = config.data;
                try {
                    if (typeof config.data === 'string') {
                        formattedData = JSON.stringify(JSON.parse(config.data), null, 2);
                    } else {
                        formattedData = JSON.stringify(config.data, null, 2);
                    }
                } catch (e) { /* keep as is if not json */ }

                content.innerHTML = `
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold">${t.viewData}</h3>
                        <button onclick="closeDataModal()" class="text-slate-400 hover:text-white">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                        </button>
                    </div>
                    <pre class="bg-black/30 p-4 rounded-xl overflow-auto max-h-[60vh] text-xs font-mono text-slate-300">${formattedData}</pre>
                    <div class="mt-6 flex justify-end">
                        <button onclick="closeDataModal()" class="px-6 py-2 bg-white/10 hover:bg-white/20 rounded-xl font-bold transition-colors">${t.close}</button>
                    </div>
                `;
                modal.classList.remove('hidden');
            }
        };

        window.closeDataModal = () => {
            const modal = document.getElementById('data-modal');
            if (modal) modal.classList.add('hidden');
        };

        async function fetchConfigsREST() {
            log("Attempting REST API fallback...");
            try {
                const url = `https://firestore.googleapis.com/v1/projects/${firebaseConfig.projectId}/databases/(default)/documents/shared_configs`;
                const response = await fetch(url);
                const data = await response.json();
                if (data.documents) {
                    allConfigs = data.documents
                        .map(doc => {
                            const fields = doc.fields;
                            const id = doc.name.split('/').pop();
                            return {
                                id: id,
                                name: fields.name?.stringValue,
                                author: fields.author?.stringValue,
                                category: fields.category?.stringValue,
                                description: fields.description?.stringValue,
                                status: fields.status?.stringValue,
                                data: fields.config_json?.stringValue || fields.data?.stringValue
                            };
                        })
                        .filter(c => c.status === 'pending');
                    dataLoaded = true;
                    renderConfigs();
                }
            } catch (e) { log("REST Fallback Error: " + e.message); }
        }

        async function fetchPlayers() {
            try {
                const snap = await getDocs(collection(db, "users"));
                allPlayers = [];
                snap.forEach(doc => allPlayers.push({ email: doc.id, ...doc.data() }));
                renderPlayers();
            } catch (e) { log("Fetch Players Error: " + e.message); }
        }

        function renderPlayers() {
            const t = i18n[currentLang] || i18n.en;
            const playerList = document.getElementById('player-list');
            if (!playerList) return;
            playerList.innerHTML = '';
            allPlayers.forEach(player => {
                const isBanned = player.ban_until && player.ban_until > Date.now();
                const tr = document.createElement('tr');
                tr.className = "border-b border-white/5 hover:bg-white/5 transition-colors cursor-pointer";
                tr.onclick = () => showPlayerDetails(player.email);
                tr.innerHTML = `
                    <td class="px-6 py-4 flex items-center gap-3">
                        <img src="https://mc-heads.net/avatar/${player.mc_name}/24" class="w-6 h-6 rounded">
                        <span class="font-bold">${player.mc_name || 'Unknown'}</span>
                    </td>
                    <td class="px-6 py-4 text-slate-400 text-sm">${player.email}</td>
                    <td class="px-6 py-4 text-slate-400 text-sm font-bold text-blue-400">${t.grades[player.grade || 'General'] || (player.grade || 'General')}</td>
                    <td class="px-6 py-4 text-slate-400 text-sm">${player.warnings || 0}</td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 rounded-full text-[10px] font-bold uppercase ${isBanned ? 'bg-red-500/10 text-red-400' : 'bg-green-500/10 text-green-400'}">
                            ${isBanned ? 'Banned' : 'Active'}
                        </span>
                    </td>
                    <td class="px-6 py-4 text-right">
                        <button class="text-blue-400 hover:text-blue-300 text-xs font-bold">Manage</button>
                    </td>
                `;
                playerList.appendChild(tr);
            });
        }

        window.showPlayerDetails = async (email) => {
            const t = i18n[currentLang] || i18n.en;
            const player = allPlayers.find(p => p.email === email);
            if (!player) return;

            const modal = document.getElementById('player-modal');
            const content = document.getElementById('player-modal-content');
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';

            content.innerHTML = '<div class="animate-pulse text-slate-500">Loading details...</div>';

            try {
                const q = query(collection(db, "shared_configs"), where("author", "==", email));
                const snap = await getDocs(q);
                let configsHtml = '';
                snap.forEach(doc => {
                    const data = doc.data();
                    configsHtml += `
                        <div class="glass p-4 flex justify-between items-center border border-white/5">
                            <div>
                                <div class="font-bold">${data.name || 'Untitled'}</div>
                                <div class="text-[10px] text-slate-500 uppercase tracking-widest mt-1">${data.status}</div>
                            </div>
                            <button onclick="deleteConfig('${doc.id}', '${email}')" class="p-2 text-red-400 hover:bg-red-400/10 rounded-lg transition-colors">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                            </button>
                        </div>
                    `;
                });

                const isBanned = player.ban_until && player.ban_until > Date.now();
                const banExpiry = isBanned ? new Date(player.ban_until).toLocaleString() : '';

                content.innerHTML = `
                    <div class="flex justify-between items-start mb-8">
                        <div class="flex items-center gap-6">
                            <img src="https://mc-heads.net/avatar/${player.mc_name}/64" class="w-16 h-16 rounded-xl shadow-2xl">
                            <div>
                                <h2 class="text-3xl font-black tracking-tighter">${player.mc_name}</h2>
                                <p class="text-slate-500">${player.email}</p>
                            </div>
                        </div>
                        <button onclick="closePlayerModal()" class="text-slate-400 hover:text-white transition-colors">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                        </button>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="space-y-6">
                            <div class="glass p-6 border border-white/5">
                                <h3 class="text-[10px] uppercase tracking-widest text-slate-500 font-bold mb-4">${t.playerBan}</h3>
                                <div class="flex gap-3 mb-4">
                                    <input type="number" id="ban-hours" placeholder="${t.banHours}" class="flex-1 bg-black/20 border border-white/10 rounded-xl px-4 py-2 text-white outline-none focus:border-blue-500 transition-colors">
                                    <button onclick="banPlayer('${email}')" class="px-6 py-2 bg-red-600 rounded-xl font-bold hover:bg-red-500 transition-colors">${t.playerBan}</button>
                                </div>
                                ${isBanned ? `<p class="text-red-400 text-xs font-bold">${t.banStatus} ${banExpiry} <button onclick="unbanPlayer('${email}')" class="ml-2 underline">${t.playerUnban}</button></p>` : `<p class="text-green-400 text-xs font-bold">${t.activeStatus}</p>`}
                            </div>
                            <div class="flex gap-3">
                                <button onclick="warnPlayer('${email}')" class="flex-1 py-3 bg-yellow-600/20 text-yellow-400 rounded-xl font-bold hover:bg-yellow-600/30 transition-colors">${t.playerWarn} (${player.warnings || 0})</button>
                                <button onclick="deletePlayer('${email}')" class="flex-1 py-3 bg-red-600/20 text-red-400 rounded-xl font-bold hover:bg-red-600/30 transition-colors">${t.playerDelete}</button>
                            </div>
                            <div class="glass p-6 border border-white/5">
                                <h3 class="text-[10px] uppercase tracking-widest text-slate-500 font-bold mb-4">${t.playerGrade}</h3>
                                <div class="flex gap-3">
                                    <select id="grade-select" class="flex-1 bg-black/20 border border-white/10 rounded-xl px-4 py-2 text-white outline-none focus:border-blue-500 transition-colors">
                                        ${Object.keys(t.grades).map(g => `<option value="${g}" ${(player.grade || 'General') === g ? 'selected' : ''}>${t.grades[g]}</option>`).join('')}
                                    </select>
                                    <button onclick="updateGrade('${email}')" class="px-6 py-2 bg-blue-600 rounded-xl font-bold hover:bg-blue-500 transition-colors">Update</button>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-[10px] uppercase tracking-widest text-slate-500 font-bold mb-4">${t.playerConfigs}</h3>
                            <div class="space-y-3">
                                ${configsHtml || `<p class="text-slate-500 italic text-sm">No configurations found.</p>`}
                            </div>
                        </div>
                    </div>
                `;
            } catch (e) { content.innerHTML = `<div class="text-red-400">Error: ${e.message}</div>`; }
        };

        window.closePlayerModal = () => { document.getElementById('player-modal').classList.add('hidden'); document.body.style.overflow = 'auto'; };
        window.banPlayer = async (email) => { const hours = parseInt(document.getElementById('ban-hours').value); if (isNaN(hours) || hours <= 0) return alert("Enter valid hours."); try { const banUntil = Date.now() + (hours * 60 * 60 * 1000); await updateDoc(doc(db, "users", email), { ban_until: banUntil }); alert("Player banned."); fetchPlayers(); showPlayerDetails(email); } catch (e) { alert("Failed to ban player."); } };
        window.unbanPlayer = async (email) => { try { await updateDoc(doc(db, "users", email), { ban_until: null }); alert("Player unbanned."); fetchPlayers(); showPlayerDetails(email); } catch (e) { alert("Failed to unban player."); } };
        window.warnPlayer = async (email) => { try { const playerRef = doc(db, "users", email); const snap = await getDoc(playerRef); const warnings = (snap.data().warnings || 0) + 1; await updateDoc(playerRef, { warnings: warnings }); alert(`Warning issued. Total: ${warnings}`); fetchPlayers(); showPlayerDetails(email); } catch (e) { alert("Failed to warn player."); } };
        window.deletePlayer = async (email) => { if (!confirm("Are you sure?")) return; try { await deleteDoc(doc(db, "users", email)); alert("Deleted."); closePlayerModal(); fetchPlayers(); } catch (e) { alert("Failed."); } };
        window.updateGrade = async (email) => { const newGrade = document.getElementById('grade-select').value; try { await updateDoc(doc(db, "users", email), { grade: newGrade }); alert("Grade updated."); fetchPlayers(); showPlayerDetails(email); } catch (e) { alert("Failed to update grade."); } };
        window.deleteConfig = async (id, email) => { if (!confirm("Delete this config?")) return; try { await deleteDoc(doc(db, "shared_configs", id)); alert("Deleted."); showPlayerDetails(email); } catch (e) { alert("Failed."); } };

        async function fetchTickets() {
            try {
                const q = query(collection(db, "support_tickets"), orderBy("timestamp", "desc"));
                const snap = await getDocs(q);
                allTickets = [];
                snap.forEach(doc => allTickets.push({ id: doc.id, ...doc.data() }));
                renderTickets();
            } catch (e) { log("Fetch Tickets Error: " + e.message); }
        }

        function renderTickets() {
            const t = i18n[currentLang] || i18n.en;
            const supportList = document.getElementById('support-list');
            if (!supportList) return;
            if (allTickets.length === 0) { supportList.innerHTML = `<div class="glass p-12 text-center text-xl">${t.noTickets}</div>`; return; }
            supportList.innerHTML = '';
            allTickets.forEach(ticket => {
                const date = new Date(ticket.timestamp).toLocaleString();
                const div = document.createElement('div');
                div.className = "glass p-6 card-hover";
                div.innerHTML = `<div class="flex justify-between items-start mb-4"><div><h3 class="text-xl font-bold">${t.ticketTitle}</h3><p class="text-slate-400 text-sm">${t.ticketUser}: ${ticket.email} (${ticket.mc_name || 'Unknown'})</p><p class="text-slate-500 text-xs">${t.ticketDate}: ${date}</p></div><button onclick="deleteTicket('${ticket.id}')" class="p-2 text-red-400 hover:bg-red-400/10 rounded-lg transition-colors"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div><div class="bg-white/5 p-4 rounded-xl border border-white/5 text-slate-300 whitespace-pre-wrap">${ticket.message}</div>`;
                supportList.appendChild(div);
            });
        }

        window.deleteTicket = async (id) => { if (!confirm("Delete ticket?")) return; try { await deleteDoc(doc(db, "support_tickets", id)); alert("Deleted."); fetchTickets(); } catch (e) { alert("Failed."); } };
        window.updateStatus = async (id, status) => { try { const docRef = doc(db, "shared_configs", id); if (status === 'approved') await updateDoc(docRef, { status: 'approved' }); else await deleteDoc(docRef); setupDataFetching(); } catch (e) { alert("Failed."); } };

        try {
            const app = initializeApp(firebaseConfig);
            auth = initializeAuth(app, {
                persistence: browserLocalPersistence,
                popupRedirectResolver: browserPopupRedirectResolver
            });
            db = initializeFirestore(app, { experimentalForceLongPolling: true });
            provider = new GoogleAuthProvider();

            onAuthStateChanged(auth, async (user) => {
                currentUser = user;
                const loginScreen = document.getElementById('login-screen');
                const adminPanel = document.getElementById('admin-panel');
                const authBtn = document.getElementById('auth-btn');

                if (user && (user.uid === ADMIN_UID || ADMIN_EMAILS.includes(user.email))) {
                    if (loginScreen) loginScreen.classList.add('hidden');
                    if (adminPanel) adminPanel.classList.remove('hidden');
                    try {
                        const userDoc = await getDoc(doc(db, "users", user.email));
                        if (userDoc.exists()) {
                            mcAccount = userDoc.data();
                            if (authBtn) {
                                authBtn.classList.remove('px-6');
                                authBtn.classList.add('px-4');
                                authBtn.innerHTML = `<div class="flex items-center gap-3"><img src="https://mc-heads.net/avatar/${mcAccount.mc_name}/32" class="w-8 h-8 rounded border border-white/20"><div class="text-left"><div class="text-[10px] opacity-50">Admin</div><div class="font-bold text-xs">${mcAccount.mc_name}</div></div></div>`;
                            }
                        } else {
                            if (authBtn) authBtn.textContent = "Admin (No MC Link)";
                        }
                    } catch (e) { log("Auth Doc Error: " + e.message); }
                    setupDataFetching();
                } else if (user) {
                    alert("Access Denied: Not an admin account (" + user.email + ")");
                    signOut(auth);
                } else {
                    if (loginScreen) loginScreen.classList.remove('hidden');
                    if (adminPanel) adminPanel.classList.add('hidden');
                }
                updateUI();
            });

            const loginBtn = document.getElementById('login-btn');
            if (loginBtn) {
                loginBtn.onclick = async () => {
                    const errorEl = document.getElementById('login-error');
                    if (errorEl) errorEl.classList.add('hidden');
                    try {
                        await signInWithPopup(auth, provider).catch(async (err) => {
                            if (['auth/popup-blocked', 'auth/popup-closed-by-user', 'auth/cancelled-popup-request', 'auth/internal-error'].includes(err.code)) {
                                await signInWithRedirect(auth, provider);
                            } else throw err;
                        });
                    } catch (e) {
                        if (errorEl) {
                            errorEl.textContent = "Login failed: " + e.message;
                            errorEl.classList.remove('hidden');
                        }
                        alert("Login failed: " + e.message);
                    }
                };
            }

            const authBtn = document.getElementById('auth-btn');
            if (authBtn) authBtn.onclick = () => { if (confirm("Logout?")) signOut(auth); };

            function setupDataFetching() {
                const q = query(collection(db, "shared_configs"), where("status", "==", "pending"));
                onSnapshot(q, (snap) => {
                    if (fetchTimeout) clearTimeout(fetchTimeout);
                    allConfigs = [];
                    snap.forEach(doc => {
                        const d = doc.data();
                        allConfigs.push({
                            id: doc.id,
                            ...d,
                            data: d.config_json || d.data
                        });
                    });
                    dataLoaded = true;
                    renderConfigs();
                }, (err) => {
                    log("SDK Error: " + err.message);
                    if (!dataLoaded) fetchConfigsREST();
                });
                fetchTimeout = setTimeout(() => { if (!dataLoaded) fetchConfigsREST(); }, 5000);
            }

            // Handle redirect result
            getRedirectResult(auth).catch((e) => log("Redirect Result Error: " + e.message));

            updateUI();
        } catch (e) { log("Init Error: " + e.message); }
    </script>
</body>

</html>
